grid ← {(∨\' '≠⍵)/⍵}¨↓⍉↑(⊃¨{~×4|2+⍳≢⍵}⊆⊢)¨8↑⊃⎕NGET 'input.txt' 1 
ins ← (⍎¨{⍵∊⎕D}⊆⊢)¨10↓⊃⎕NGET 'input.txt' 1

move1 ← { 
  lr ← (1⌷⍺) (↑{(⌽⍺)⍵}↓) ⊃⍵[2⌷⍺]
  ⊃¨({⊂,/(⊃1⌷lr),⊃⍵} @ (3⌷⍺)) ((⊂2⌷lr) @ (2⌷⍺)) ⊂¨⍵
}
move2 ← { 
  lr ← (1⌷⍺) (↑{⍺⍵}↓) ⊃⍵[2⌷⍺]
  ⊃¨({⊂,/(⊃1⌷lr),⊃⍵} @ (3⌷⍺)) ((⊂2⌷lr) @ (2⌷⍺)) ⊂¨⍵
}

⊃¨ins{0=≢⍺:⍵ ⋄ (1↓⍺)∇(⍵ move1⍨ ⊃⍺)}grid
⊃¨ins{0=≢⍺:⍵ ⋄ (1↓⍺)∇(⍵ move2⍨ ⊃⍺)}grid
